{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": { "text": "Malaysia's Population (Based on age range)"},
    "data": {
    "url": "https://raw.githubusercontent.com/3arhead/3179-visualization/main/data/population.csv"
    },
    "transform": [
        {"calculate": "datum.pop_below_18","as": "Below 18"},
        {"calculate": "datum.pop_60","as": "60+"},
        {"calculate": "datum.pop_18","as": "18+"},
        {"fold": ["Below 18", "60+", "18+"], "as": ["age_range", "population"]},
        {"filter": {"selection": "pop_range"}}
        ],
    "selection": {
        "pop_range": {
        "type": "single",
        "init": {"age_range": "18+"},
        "bind": {
            "age_range": {
            "name": "Age Range:",
            "input": "select",
            "options": [
                "Below 18",
                "18+",
                "60+"
            ]
            }
        }
        }
    },
    "mark": "bar",
    "encoding": {
        "color": {
            "field": "age_range",
            "type": "nominal",
            "scale": {"range":["red","green","blue"], "domain":["Below 18","18+","60+"]}
        },
      "x": { "field": "state", "type": "nominal", "sort":"y" },
      "y": { "field": "population", "type": "quantitative"},
      "row": {
      "field": "age_range",
      "type": "nominal",
      "title": null
       },
       "tooltip": [
        {"field": "state", "type": "nominal", "title": "State"},
        {"field": "age_range", "type": "nominal", "title": "Age Range"},
        {"field": "population", "type": "quantitative", "title": "Population"}
      ]
    }
}
